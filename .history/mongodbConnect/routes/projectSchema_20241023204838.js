var express = require('express');
var router = express.Router();

router.get('/get', async (req, res, next) => {
  try {
    const docs = await M.projectSchema.find({}).sort({ seq: 1 });
    console.log('查询到的数据为', docs);
    res.json(docs);
  } catch (error) {
    console.error('Error fetching data:', error);
    next(error); // 将错误传递给下一个中间件或错误处理程序
  }
});

router.post('/add', async (req, res, next) => {
  try {
    const docs = await M.projectSchema.create({
      key: 1,
      name: "page1",
      content: {"version":"1.0.0","componentsMap":[{"package":"@alilc/lowcode-materials","version":"1.0.7","exportName":"NextText","main":"lib/index.js","destructuring":true,"subName":"","componentName":"NextText"},{"package":"@alifd/layout","version":"2.4.1","exportName":"P","main":"lib/index.js","destructuring":true,"subName":"","componentName":"FDP"},{"package":"@alifd/layout","version":"2.4.1","exportName":"Cell","main":"lib/index.js","destructuring":true,"subName":"","componentName":"FDCell"},{"package":"@alifd/layout","version":"2.4.1","exportName":"Block","main":"lib/index.js","destructuring":true,"subName":"","componentName":"FDBlock"},{"package":"@alifd/next","version":"1.25.23","exportName":"Button","main":"","destructuring":true,"subName":"","componentName":"Button"},{"package":"@alifd/layout","version":"2.4.1","exportName":"Row","main":"lib/index.js","destructuring":true,"subName":"","componentName":"FDRow"},{"package":"@alifd/layout","version":"2.4.1","exportName":"Section","main":"lib/index.js","destructuring":true,"subName":"","componentName":"FDSection"},{"package":"@alifd/layout","version":"2.4.1","exportName":"Page","main":"lib/index.js","destructuring":true,"componentName":"FDPage"},{"package":"material-table-rubber","version":"0.1.0","exportName":"default","main":"src\\index.tsx","destructuring":false,"subName":"","componentName":"MaterialTableRubber"},{"devMode":"lowCode","componentName":"Page"}],"componentsTree":[{"componentName":"Page","id":"node_dockcviv8fo1","props":{"ref":"outerView","style":{"height":"100%"}},"docId":"doclaqkk3b9","fileName":"/","dataSource":{"list":[{"type":"fetch","isInit":true,"options":{"params":{},"method":"GET","isCors":true,"timeout":5000,"headers":{},"uri":"mock/info.json"},"id":"info","shouldFetch":{"type":"JSFunction","value":"function() { \n  console.log('should fetch.....');\n  return true; \n}"}}]},"state":{"text":{"type":"JSExpression","value":"\"outer\""},"isShowDialog":{"type":"JSExpression","value":"false"}},"css":"body {\n  font-size: 12px;\n}\n\n.button {\n  width: 100px;\n  color: #ff00ff\n}","lifeCycles":{"componentDidMount":{"type":"JSFunction","value":"function componentDidMount() {\n  console.log('did mount');\n}"},"componentWillUnmount":{"type":"JSFunction","value":"function componentWillUnmount() {\n  console.log('will unmount');\n}"}},"methods":{"testFunc":{"type":"JSFunction","value":"function testFunc() {\n  console.log('test func');\n}"},"onClick":{"type":"JSFunction","value":"function onClick() {\n  this.setState({\n  isShowDialog: true\n  });\n}"},"closeDialog":{"type":"JSFunction","value":"function closeDialog() {\n  this.setState({\n  isShowDialog: false\n  });\n}"},"getHelloWorldText":{"type":"JSFunction","value":"function getHelloWorldText() {\n  return this.i18n('i18n-jwg27yo4');\n}"},"getHelloWorldText2":{"type":"JSFunction","value":"function getHelloWorldText2() {\n  return this.i18n('i18n-jwg27yo3', {\n  name: '絮黎'\n  });\n}"},"onTestConstantsButtonClicked":{"type":"JSFunction","value":"function onTestConstantsButtonClicked() {\n  console.log('constants.ConstantA:', this.constants.ConstantA);\n  console.log('constants.ConstantB:', this.constants.ConstantB);\n}"},"onTestUtilsButtonClicked":{"type":"JSFunction","value":"function onTestUtilsButtonClicked() {\n  this.utils.demoUtil('param1', 'param2');\n}"}},"originCode":"class LowcodeComponent extends Component {\n  state = {\n    \"text\": \"outer\",\n    \"isShowDialog\": false\n  }\n  componentDidMount() {\n    console.log('did mount');\n  }\n  componentWillUnmount() {\n    console.log('will unmount');\n  }\n  testFunc() {\n    console.log('test func');\n  }\n  onClick() {\n    this.setState({\n      isShowDialog: true\n    });\n  }\n  closeDialog() {\n    this.setState({\n      isShowDialog: false\n    });\n  }\n  getHelloWorldText() {\n    return this.i18n('i18n-jwg27yo4');\n  }\n  getHelloWorldText2() {\n    return this.i18n('i18n-jwg27yo3', {\n      name: '絮黎',\n    });\n  }\n  onTestConstantsButtonClicked() {\n    console.log('constants.ConstantA:', this.constants.ConstantA);\n    console.log('constants.ConstantB:', this.constants.ConstantB);\n\t}\n\tonTestUtilsButtonClicked(){\n    this.utils.demoUtil('param1', 'param2');\n\t}\n}","hidden":false,"title":"","isLocked":false,"condition":true,"conditionGroup":"","children":[{"componentName":"FDPage","id":"node_oclfjpfqjy5","props":{"contentProps":{"style":{"background":"rgba(255,255,255,0)"}},"ref":"fdpage-bb43fbb0"},"title":"页面","hidden":false,"isLocked":false,"condition":true,"conditionGroup":"","children":[{"componentName":"FDSection","id":"node_oclfjpfqjy6","props":{"style":{"backgroundColor":"rgba(255,255,255,1)","minHeight":""}},"title":"区域","hidden":false,"isLocked":false,"condition":true,"conditionGroup":"","children":[{"componentName":"FDBlock","id":"node_oclfjpfqjy7","props":{"mode":"transparent","span":12},"title":"区块","hidden":false,"isLocked":false,"condition":true,"conditionGroup":"","children":[{"componentName":"FDCell","id":"node_oclfjpfqjy8","props":{"align":"left","verAlign":"top","style":{"backgroundColor":"rgba(255,255,255,1)"},"width":""},"title":"容器","hidden":false,"isLocked":false,"condition":true,"conditionGroup":"","children":[{"componentName":"FDP","id":"node_oclfjpfqjy10","props":{},"title":"段落","hidden":false,"isLocked":false,"condition":true,"conditionGroup":"","children":[{"componentName":"NextText","id":"node_oclfjpfqjyz","props":{"type":"h1","children":"Home","mark":false,"code":false,"delete":false,"underline":false,"strong":false,"prefix":"","classname":"","style":{"fontSize":"25px"}},"hidden":false,"title":"","isLocked":false,"condition":true,"conditionGroup":""}]}]}]},{"componentName":"FDBlock","id":"node_oclfjpfqjy9","props":{"mode":"transparent","span":12,"style":{"backgroundColor":"rgba(255,255,255,1)","minHeight":""}},"title":"区块","hidden":false,"isLocked":false,"condition":true,"conditionGroup":"","children":[{"componentName":"FDRow","id":"node_oclfjpfqjy11","props":{"style":{"backgroundColor":"rgba(255,255,255,1)"}},"title":"行容器","hidden":false,"isLocked":false,"condition":true,"conditionGroup":"","children":[{"componentName":"FDCell","id":"node_oclfjpfqjya","props":{"align":"left","verAlign":"top","style":{"backgroundColor":"rgba(255,255,255,1)"},"width":""},"title":"容器","hidden":false,"isLocked":false,"condition":true,"conditionGroup":"","children":[{"componentName":"FDP","id":"node_oclfjqcdwn14","props":{},"title":"段落","hidden":false,"isLocked":false,"condition":true,"conditionGroup":"","children":[{"componentName":"NextText","id":"node_oclfjqcdwn13","props":{"type":"h5","children":"多语言展示","mark":false,"code":false,"delete":false,"underline":false,"strong":false,"prefix":"","classname":"","style":{"fontSize":"18px"}},"hidden":false,"title":"","isLocked":false,"condition":true,"conditionGroup":""}]},{"componentName":"FDP","id":"node_oclfjqcdwn2k","props":{},"title":"段落","hidden":false,"isLocked":false,"condition":true,"conditionGroup":"","children":[{"componentName":"NextText","id":"node_oclfjqcdwn2j","props":{"type":"inherit","children":{"type":"JSExpression","value":"this.getHelloWorldText()","mock":""},"mark":false,"code":false,"delete":false,"underline":false,"strong":false,"prefix":"","classname":""},"hidden":false,"title":"","isLocked":false,"condition":true,"conditionGroup":""},{"componentName":"NextText","id":"node_oclfjqcf7z15","props":{"type":"inherit","children":{"type":"JSExpression","value":"this.getHelloWorldText2()","mock":"基于 Ali-Lowcode-Engine 快速打造高生产力的低代码研发平台, 基于自然布局体系快速搭建页面"},"mark":false,"code":false,"delete":false,"underline":false,"strong":false,"prefix":"","classname":""},"hidden":false,"title":"","isLocked":false,"condition":true,"conditionGroup":""}]}]},{"componentName":"FDCell","id":"node_oclfjpfqjy12","props":{"align":"left","verAlign":"top","style":{"backgroundColor":"rgba(255,255,255,1)"}},"title":"容器","hidden":false,"isLocked":false,"condition":true,"conditionGroup":"","children":[{"componentName":"FDP","id":"node_oclfjqcf7z2h","props":{},"title":"段落","hidden":false,"isLocked":false,"condition":true,"conditionGroup":"","children":[{"componentName":"NextText","id":"node_oclfjqcf7z2g","props":{"type":"h5","children":"交互展示","mark":false,"code":false,"delete":false,"underline":false,"strong":false,"prefix":"","classname":"","style":{"fontSize":"18px"}},"hidden":false,"title":"","isLocked":false,"condition":true,"conditionGroup":""}]},{"componentName":"FDP","id":"node_oclfjqcf7z2l","props":{},"title":"段落","hidden":false,"isLocked":false,"condition":true,"conditionGroup":"","children":[{"componentName":"Button","id":"node_oclfjqcf7z2k","props":{"prefix":"next-","type":"primary","size":"medium","htmlType":"button","component":"button","children":"constants","iconSize":"xxs","loading":false,"text":false,"warning":false,"disabled":false,"ref":"button-4951c2d3","__events":{"eventDataList":[{"type":"componentEvent","name":"onClick","relatedEventName":"onTestConstantsButtonClicked"}],"eventList":[{"name":"onClick","description":"点击按钮的回调\n@param {Object} e Event Object","disabled":true},{"name":"onMouseUp","disabled":false}]},"onClick":{"type":"JSFunction","value":"function(){this.onTestConstantsButtonClicked.apply(this,Array.prototype.slice.call(arguments).concat([])) }"}},"docId":"doclawu71ac","hidden":false,"title":"","isLocked":false,"condition":true,"conditionGroup":""},{"componentName":"Button","id":"node_oclfjqcf7z2o","props":{"prefix":"next-","type":"primary","size":"medium","htmlType":"button","component":"button","children":"utils","iconSize":"xxs","loading":false,"text":false,"warning":false,"disabled":false,"__events":{"eventDataList":[{"type":"componentEvent","name":"onClick","relatedEventName":"onTestUtilsButtonClicked"}],"eventList":[{"name":"onClick","description":"点击按钮的回调\n@param {Object} e Event Object","disabled":true},{"name":"onMouseUp","disabled":false}]},"onClick":{"type":"JSFunction","value":"function(){this.onTestUtilsButtonClicked.apply(this,Array.prototype.slice.call(arguments).concat([])) }"}},"docId":"doclawu71ac","hidden":false,"title":"","isLocked":false,"condition":true,"conditionGroup":""}]}]}]}]},{"componentName":"FDBlock","id":"node_oclfjqcf7z3g","props":{"mode":"transparent","span":12,"style":{"backgroundColor":"rgba(255,255,255,1)","minHeight":""}},"title":"区块","hidden":false,"isLocked":false,"condition":true,"conditionGroup":"","children":[{"componentName":"FDCell","id":"node_oclfjqcf7z3h","props":{"align":"left","verAlign":"top","style":{"backgroundColor":"rgba(255,255,255,1)"}},"title":"容器","hidden":false,"isLocked":false,"condition":true,"conditionGroup":"","children":[{"componentName":"FDP","id":"node_oclfjqcf7z43","props":{},"title":"段落","hidden":false,"isLocked":false,"condition":true,"conditionGroup":"","children":[{"componentName":"NextText","id":"node_oclfjqcf7z42","props":{"type":"inherit","children":"Powered By Lowcode Engine","mark":false,"code":false,"delete":false,"underline":false,"strong":false,"prefix":"","classname":"","style":{"height":"30px","lineHeight":"30px","fontSize":"20px"}},"hidden":false,"title":"","isLocked":false,"condition":true,"conditionGroup":""}]}]}]}]}]},{"componentName":"MaterialTableRubber","id":"node_ocm2ltc9oa81","props":{"dataSource":[{"disabled":false,"_id":"6704c999c1b68730582fd0cd","key":1728367001429,"name":"TradeCode 967","desc":"desc","callNo":101,"status":"3","updatedAt":"2024-10-08T05:56:41.453Z","createdAt":"2024-10-08T05:56:41.453Z","__v":0},{"disabled":false,"_id":"6704d7ce690ddf74fc4501cc","key":1728370638096,"name":"Test Error","desc":"3","callNo":3,"status":"3","updatedAt":"2024-10-08T06:57:18.125Z","createdAt":"2024-10-08T06:57:18.125Z","__v":0},{"disabled":false,"_id":"6704d7e1690ddf74fc4501cd","key":1728370657278,"name":"Closed","desc":"2","callNo":2,"status":"2","updatedAt":"2024-10-08T06:57:37.300Z","createdAt":"2024-10-08T06:57:37.300Z","__v":0},{"disabled":false,"_id":"6704d8f6690ddf74fc4501d2","key":1728370934413,"name":"1","desc":"111","callNo":1,"status":"1","updatedAt":"2024-10-08T07:02:14.422Z","createdAt":"2024-10-08T07:02:14.422Z","__v":0},{"disabled":false,"_id":"6704d90a690ddf74fc4501d3","key":1728370954108,"name":"2","desc":"222","callNo":2,"status":"2","updatedAt":"2024-10-08T07:02:34.122Z","createdAt":"2024-10-08T07:02:34.122Z","__v":0},{"disabled":false,"_id":"6704ecc331ec3b1ad4a4da69","key":1728376003338,"name":"dasdd'd'dxx","desc":"dasdads","callNo":1111,"status":"1","updatedAt":"2024-10-08T08:26:43.357Z","createdAt":"2024-10-08T08:26:43.357Z","__v":0},{"disabled":false,"_id":"6704ecc531ec3b1ad4a4da6a","key":1728376005836,"name":"dasd","desc":"dasdads","callNo":1111,"status":"1","updatedAt":"2024-10-08T08:26:45.842Z","createdAt":"2024-10-08T08:26:45.842Z","__v":0},{"disabled":false,"_id":"6704ecc631ec3b1ad4a4da6b","key":1728376006299,"name":"dasd","desc":"dasdads","callNo":1111,"status":"1","updatedAt":"2024-10-08T08:26:46.304Z","createdAt":"2024-10-08T08:26:46.304Z","__v":0},{"disabled":false,"_id":"6704ecc631ec3b1ad4a4da6c","key":1728376006466,"name":"dasd","desc":"dasdads","callNo":1111,"status":"1","updatedAt":"2024-10-08T08:26:46.472Z","createdAt":"2024-10-08T08:26:46.472Z","__v":0},{"disabled":false,"_id":"6704ecec31ec3b1ad4a4da6f","key":1728376044098,"name":"dasdadfafvcxx","desc":"ddddddd","callNo":11,"status":"2","updatedAt":"2024-10-08T08:27:24.107Z","createdAt":"2024-10-08T08:27:24.107Z","__v":0},{"disabled":false,"_id":"6704ee6831ec3b1ad4a4da71","key":1728376424686,"name":"dasdas","desc":"fdasfas","callNo":444,"status":"1","updatedAt":"2024-10-08T08:33:44.703Z","createdAt":"2024-10-08T08:33:44.703Z","__v":0},{"disabled":false,"_id":"6704eea431ec3b1ad4a4da72","key":1728376484006,"name":"ccc","desc":"dadas","callNo":111,"status":"2","updatedAt":"2024-10-08T08:34:44.020Z","createdAt":"2024-10-08T08:34:44.020Z","__v":0},{"disabled":false,"_id":"6704eec231ec3b1ad4a4da73","key":1728376514695,"name":"jkfghadsklfhaslkjfh","desc":"fasdfasdf","callNo":1111233,"status":"3","updatedAt":"2024-10-08T08:35:14.712Z","createdAt":"2024-10-08T08:35:14.712Z","__v":0},{"disabled":false,"_id":"6704eede31ec3b1ad4a4da74","key":1728376542873,"name":"dddd","desc":"dasd","callNo":1,"status":"2","updatedAt":"2024-10-08T08:35:42.888Z","createdAt":"2024-10-08T08:35:42.888Z","__v":0},{"disabled":false,"_id":"6704ef0a31ec3b1ad4a4da75","key":1728376586636,"name":"cxzc","desc":"dasda","callNo":1,"status":"1","updatedAt":"2024-10-08T08:36:26.655Z","createdAt":"2024-10-08T08:36:26.655Z","__v":0},{"disabled":false,"_id":"6704ef2131ec3b1ad4a4da76","key":1728376609001,"name":"ddd","desc":"1111","callNo":1,"status":"2","updatedAt":"2024-10-08T08:36:49.011Z","createdAt":"2024-10-08T08:36:49.011Z","__v":0},{"disabled":false,"_id":"6704ef4331ec3b1ad4a4da77","key":1728376643455,"name":"111","desc":"111111","callNo":11111,"status":"1","updatedAt":"2024-10-08T08:37:23.476Z","createdAt":"2024-10-08T08:37:23.476Z","__v":0},{"disabled":false,"_id":"6704ef6a31ec3b1ad4a4da78","key":1728376682200,"name":"222","desc":"2222222","callNo":22222,"status":"0","updatedAt":"2024-10-08T08:38:02.216Z","createdAt":"2024-10-08T08:38:02.216Z","__v":0},{"disabled":false,"_id":"6704ef7a31ec3b1ad4a4da79","key":1728376698721,"name":"333","desc":"3333","callNo":333,"status":"2","updatedAt":"2024-10-08T08:38:18.733Z","createdAt":"2024-10-08T08:38:18.733Z","__v":0},{"disabled":false,"_id":"6704efdb31ec3b1ad4a4da7b","key":1728376795392,"name":"777","desc":"7777","callNo":777,"status":"1","updatedAt":"2024-10-08T08:39:55.410Z","createdAt":"2024-10-08T08:39:55.410Z","__v":0},{"disabled":false,"_id":"6704f044c66dc55fc04b8cd4","key":1728376900911,"name":"999","desc":"999","callNo":999,"status":"3","updatedAt":"2024-10-08T08:41:40.976Z","createdAt":"2024-10-08T08:41:40.976Z","__v":0},{"disabled":false,"_id":"6704f09dc66dc55fc04b8cd5","key":1728376989208,"name":"1212333","desc":"1221213dasdas","callNo":12123,"status":"3","updatedAt":"2024-10-08T08:43:09.217Z","createdAt":"2024-10-08T08:43:09.217Z","__v":0},{"disabled":false,"_id":"67050867d3b28e3880ef6ce4","key":1728383079179,"name":"dd","desc":"33das","callNo":111,"status":"1","updatedAt":"2024-10-08T10:24:39.191Z","createdAt":"2024-10-08T10:24:39.191Z","__v":0}],"Sign":"table"},"hidden":false,"title":"","isLocked":false,"condition":true,"conditionGroup":""}]}],"i18n":{"zh-CN":{"i18n-jwg27yo4":"你好 ","i18n-jwg27yo3":"{name} 博士"},"en-US":{"i18n-jwg27yo4":"Hello ","i18n-jwg27yo3":"Doctor {name}"}}},
    });
    console.log('添加成功, 返回的数据为', docs);
    res.json(docs);
  } catch (error) {
    console.error('Error adding data:', error);
    next(error);
  }
});
  


module.exports = router;
